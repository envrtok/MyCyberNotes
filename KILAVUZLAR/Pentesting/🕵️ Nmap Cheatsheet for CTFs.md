A **CTF-oriented Nmap cheatsheet** will save you tons of time.

---
## ğŸ”¹ 1. Host Discovery

```bash
nmap -sn 10.10.11.82
```

- `-sn` â†’ Ping scan (is host up?)
    
- Add `-Pn` if ICMP is blocked (treat all hosts as alive).
    

---

## ğŸ”¹ 2. Full Port Discovery

```bash
nmap -p- -sS -T4 -Pn -n -v 10.10.11.82 -oN full-tcp.txt
```

- `-p-` â†’ All 65k ports
    
- `-sS` â†’ SYN scan (fast/stealthy)
    
- `-T4` â†’ Faster timing (use `-T3` if network is unstable)
    
- `-Pn` â†’ Skip host discovery, assume alive
    
- `-n` â†’ Donâ€™t resolve DNS â†’ faster
    
- `-oN` â†’ Save results
    

âœ… Use this first to avoid missing hidden services.

---

## ğŸ”¹ 3. Targeted Service & Script Scan

```bash
nmap -sV -sC -p22,80,8080 10.10.11.82 -oN targeted.txt
```

- `-sV` â†’ Version detection
    
- `-sC` â†’ Default NSE scripts
    
- `-p` â†’ Only scan ports you already found
    

---

## ğŸ”¹ 4. Aggressive Enumeration (After Discovery)

```bash
nmap -A -p22,80,8080 10.10.11.82
```

- `-A` â†’ OS detection + version + traceroute + NSE  
    âš ï¸ Use **after you know ports**, not on a full scan (too slow/noisy).
    

---

## ğŸ”¹ 5. UDP Scan

```bash
nmap -sU --top-ports 200 -T4 10.10.11.82 -oN top-udp.txt
```

- `-sU` â†’ UDP scan
    
- `--top-ports 200` â†’ Common UDP services
    

---

## ğŸ”¹ 6. Dealing with Missing Ports

- Increase retries if ports drop:
    
    ```bash
    nmap -p- --max-retries 5 -sS -T3 10.10.11.82
    ```
    
- Scan slower if network is unstable:
    
    ```bash
    nmap -p- -sS -T2 10.10.11.82
    ```
    

---

## ğŸ”¹ 7. NSE Script Usage

Run specific categories:

```bash
nmap --script=vuln -p80 10.10.11.82
nmap --script=http-enum -p80 10.10.11.82
```

- Useful categories: `auth`, `default`, `discovery`, `safe`, `vuln`.
    

---

## ğŸ”¹ 8. Output Options

- Normal: `-oN result.txt`
    
- Grepable: `-oG result.gnmap`
    
- XML (for tools): `-oX result.xml`
    

---

## ğŸ”¹ 9. Quick â€œAll-in-Oneâ€ Workflow

1. **Find ports**
    
    ```bash
    nmap -p- -sS -T4 -Pn -n 10.10.11.82 -oN full-tcp.txt
    ```
    
2. **Enumerate services**
    
    ```bash
    nmap -sV -sC -p<ports> 10.10.11.82 -oN targeted.txt
    ```
    
3. **Deep dive if needed**
    
    ```bash
    nmap -A -p<ports> 10.10.11.82 -oN aggressive.txt
    ```
    
4. **UDP check (if stuck)**
    
    ```bash
    nmap -sU --top-ports 200 10.10.11.82 -oN udp.txt
    ```
    

---